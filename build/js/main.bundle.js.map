{"version":3,"sources":["webpack://keksobooking/./source/js/avatar.js","webpack://keksobooking/webpack/bootstrap","webpack://keksobooking/./source/js/utils.js","webpack://keksobooking/./source/js/card.js","webpack://keksobooking/./source/js/popup.js","webpack://keksobooking/./source/js/form.js","webpack://keksobooking/./source/js/data.js","webpack://keksobooking/./source/js/filter.js","webpack://keksobooking/./source/js/map.js","webpack://keksobooking/./source/js/main.js"],"names":["FILE_TYPES","onFileUpload","fileChooser","preview","fileTypes","evt","preventDefault","file","files","fileName","name","toLowerCase","some","it","endsWith","reader","FileReader","addEventListener","src","result","readAsDataURL","avatarChooser","document","querySelector","previewAvatar","photoChooser","upload","previewPhoto","createElement","style","display","maxWidth","height","append","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","offerTemplate","content","successPopup","cloneNode","errorPopup","tryAgainButton","classList","add","body","closeModal","modal","onClick","onPopupKeydown","key","isEscEvent","isEnterEvent","removeEventListener","showModal","remove","zIndex","adForm","adFormFieldsets","querySelectorAll","titleInput","currentPrice","address","houseTypeList","checkInTime","checkOutTime","selectRoomNumber","resetButton","selectCapacity","mapForm","mapFormFieldsets","minPrices","bungalow","flat","house","palace","getAddress","lat","lng","latitude","toFixed","longitude","value","numberOfRooms","1","2","3","100","forEach","input","setAttribute","space","onRoomsNumberSelect","capacityOptions","roomsNumber","Number","availableRooms","option","disabled","numberOfSeats","includes","maxCapacity","length","placeholder","price","type","minPrice","setCustomValidity","reportValidity","min","valueLength","formReset","reset","resetMap","onSuccess","onError","formData","FormData","target","url","fetch","method","then","response","ok","catch","sendData","filterType","filterPrice","filterRooms","filterGuests","filterFeatures","getFilteredOffer","data","offer","checkType","checkPrice","rooms","checkRooms","guests","checkGuests","checkedFeatures","count","feature","features","checkFeatures","STARTING_LATITUDE","STARTING_LONGITUDE","map","L","on","removeAttribute","setView","tileLayer","attribution","addTo","mainPinIcon","icon","iconUrl","iconSize","iconAnchor","mainPinMarker","marker","draggable","onPinMove","getLatLng","long","markers","createDefaultPin","poster","slice","filter","location","defaultPinIcon","bindPopup","author","newOfferElement","featureContainer","photosContainer","container","textContent","title","checkin","checkout","featuresElement","element","innerHTML","join","renderFeatures","photos","item","img","width","appendChild","avatar","offerShow","push","setLatLng","latLng","json","text","cb","_","debounce","getData","message","alertContainer","position","left","top","right","padding","fontSize","textAlign","backgroundColor","setTimeout","showError"],"mappings":"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","file":"main.bundle.js","sourcesContent":["const FILE_TYPES = ['gif', 'jpg', 'jpeg', 'png'];\n\nconst onFileUpload = (fileChooser, preview, fileTypes) => {\n    return (evt) => {\n      evt.preventDefault();\n      const file = fileChooser.files[0];\n      const fileName = file.name.toLowerCase();\n  \n      const matches = fileTypes.some((it) => {\n        return fileName.endsWith(it);\n      });\n  \n      if (matches) {\n        const reader = new FileReader();\n  \n        reader.addEventListener('load', () => {\n          preview.src = reader.result;\n        });\n  \n        reader.readAsDataURL(file);\n      }\n    }\n};\n  \nconst avatarChooser = document.querySelector('.ad-form__field input[type=file]');\nconst previewAvatar = document.querySelector('.ad-form-header__preview img');\nconst photoChooser = document.querySelector('.ad-form__upload input[type=file]');\nconst upload = document.querySelector('.ad-form__photo');\nconst previewPhoto = document.createElement('img');\npreviewPhoto.style.display = 'flex';\npreviewPhoto.style.maxWidth = '100%';\npreviewPhoto.style.height = 'auto';\n\nupload.append(previewPhoto);\n\n\navatarChooser.addEventListener('change', onFileUpload(avatarChooser, previewAvatar, FILE_TYPES));\n\nphotoChooser.addEventListener('change', onFileUpload(photoChooser, previewPhoto, FILE_TYPES));\n\n\n\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","const ALERT_SHOW_TIME = 5000;\n\nconst getRandomNumber = function (from, to, signsQuantity) {\n  if(from > to || from === to) {\n    throw new Error('Значение \"от\" не может быть больше или равнятся значению \"до\"!');\n  }\n    \n  if (from < 0 || to < 0 ) {\n    throw new Error('Значения не могут быть меньше нуля!');\n  }\n    \n  let rand = from + Math.random() * (to - from);\n  return rand.toFixed(signsQuantity);\n    \n}\n\nconst getRandomArrayElement = (elements) => {\n  return elements[getRandomNumber(0, elements.length - 1)];\n}\n\nconst getOfferType = (type) => {\n  const offers = {\n    flat: 'Квартрира',\n    bungalow: 'Бунгало',\n    house: 'Дом',\n    palace: 'Дворец',\n  }\n  return offers[type];\n};\n\nconst showError = (message='Не удалось загрузить данные') => {\n  return () => {\n    const alertContainer = document.createElement('div');\n    alertContainer.style.display = 'block';\n    alertContainer.style.zIndex = '100';\n    alertContainer.style.position = 'absolute';\n    alertContainer.style.left = '0';\n    alertContainer.style.top = '0';\n    alertContainer.style.right = '0';\n    alertContainer.style.padding = '10px 3px';\n    alertContainer.style.fontSize = '30px';\n    alertContainer.style.textAlign = 'center';\n    alertContainer.style.backgroundColor = 'red';\n    alertContainer.textContent = message;\n\n    document.body.append(alertContainer);\n\n    setTimeout(() => {\n      alertContainer.remove();\n    }, ALERT_SHOW_TIME);\n  }\n};\n\nconst isEscEvent = (evt) => {\n  return evt.key === 'Escape' || evt.key === 'Esc';\n};\n\nconst isEnterEvent = (evt) => evt.key === 'Enter';\n\n\nexport {\n  getRandomArrayElement,\n  getRandomNumber, \n  getOfferType, \n  showError, \n  isEscEvent, \n  isEnterEvent,\n\n};\n","import {getOfferType} from './utils.js';\n\nconst offerTemplate = document.querySelector('#card').content.querySelector('.popup');\n\nconst isElementVisible = (element, components) => {\n  if (components.length === 0) {\n    element.setAttribute('style', 'visibility: hidden;');\n    return false;\n  }\n  element.setAttribute('style', 'visibility: visible;');\n  return true;\n};\n\nconst renderFeatures = (featuresElement, offer) => {\n  if (!isElementVisible(featuresElement, offer.features)) {\n    return;\n  }\n\n  featuresElement.innerHTML = offer.features.map((feature) => {\n    return `<li class=\"popup__feature popup__feature--${feature}\"></li>`;\n  }).join('');\n};\n\nconst renderPhotos = (container, data) => {\n  container.innerHTML = ''; //очистка контейнера с шаблонами\n  data.forEach((item) => {\n    const img = document.createElement('img'); // создание элемента\n    img.src = item;\n    img.width = 45;\n    img.height = 40;\n    container.appendChild(img) // добавление в контейнер элемента\n    \n  })\n};\n\n\nconst offerShow = (({author, offer}) => {\n  const newOfferElement = offerTemplate.cloneNode(true);\n    \n  const featureContainer = newOfferElement.querySelector('.popup__features');\n  const photosContainer = newOfferElement.querySelector('.popup__photos'); \n\n  newOfferElement.querySelector('.popup__title').textContent = offer.title;\n  newOfferElement.querySelector('.popup__text--address').textContent = offer.address;\n  newOfferElement.querySelector('.popup__text--price').textContent = offer.price;\n  newOfferElement.querySelector('.popup__type').textContent = getOfferType(offer.type);\n  newOfferElement.querySelector('.popup__text--capacity').textContent = offer.rooms + ' комнаты для ' + offer.guests + ' гостей.';\n  newOfferElement.querySelector('.popup__text--time').textContent = ' Заезд после ' + offer.checkin + ', выезд до ' + offer.checkout;\n  renderFeatures(featureContainer, offer);\n  renderPhotos(photosContainer, offer.photos);\n  newOfferElement.querySelector('.popup__avatar').src = author.avatar;\n  \n  return newOfferElement;\n});\n\n\nexport {offerShow}","import {isEnterEvent, isEscEvent} from './utils.js';\r\n\r\nconst MODAL_ZINDEX = '1000';\r\nconst successPopup = document.querySelector('#success').content.querySelector('.success').cloneNode(true);\r\nconst errorPopup = document.querySelector('#error').content.querySelector('.error').cloneNode(true);\r\nconst tryAgainButton = errorPopup.querySelector('.error__button');\r\n\r\nsuccessPopup.classList.add('hidden');\r\nerrorPopup.classList.add('hidden');\r\ndocument.body.append(successPopup);\r\ndocument.body.append(errorPopup);\r\n\r\nconst closeModal = (modal) => {\r\n  modal.classList.add('hidden');\r\n};\r\n\r\nconst onClick = (modal) => {\r\n  return (evt) => {\r\n    evt.preventDefault();\r\n    closeModal(modal);\r\n  }\r\n};\r\n\r\nconst onPopupKeydown = (modal) => {\r\n  return (evt) => {\r\n    if (isEscEvent(evt) || isEnterEvent(evt)) {\r\n      evt.preventDefault();\r\n      document.removeEventListener('keydown', onPopupKeydown(modal));\r\n      modal.removeEventListener('click', onClick(modal));\r\n      closeModal(modal);\r\n    }\r\n    if (modal === errorPopup) {\r\n      tryAgainButton.removeEventListener('click', onClick(errorPopup));\r\n    }\r\n  }\r\n};\r\n\r\n\r\nconst showModal = (modal) => {\r\n  modal.classList.remove('hidden');\r\n  modal.style.zIndex = MODAL_ZINDEX;\r\n  document.addEventListener('keydown', onPopupKeydown(modal));\r\n  modal.addEventListener('click', onClick(modal));\r\n}\r\n\r\nconst showSuccessPopup = () => {\r\n  showModal(successPopup);\r\n};\r\n\r\nconst showErrorPopup = () => {\r\n  showModal(errorPopup);\r\n  tryAgainButton.addEventListener('click', onClick(errorPopup));\r\n};\r\n\r\n\r\nexport {showErrorPopup, showSuccessPopup};","import {FIXED_NUMBER, POST_URL, sendData} from './data.js';\nimport {resetMap} from './map.js'\nimport {showErrorPopup, showSuccessPopup} from './popup.js';\n\nconst adForm = document.querySelector('.ad-form');\nconst adFormFieldsets = adForm.querySelectorAll('fieldset');\n\nconst titleInput = adForm.querySelector('#title');\nconst currentPrice = adForm.querySelector('#price');\nconst address = adForm.querySelector('#address');\nconst houseTypeList = adForm.querySelector('#type');\nconst checkInTime = adForm.querySelector('#timein');\nconst checkOutTime = adForm.querySelector('#timeout');\nconst selectRoomNumber = adForm.querySelector('#room_number');\nconst resetButton = adForm.querySelector('.ad-form__reset');\nconst selectCapacity = adForm.querySelector('#capacity');\n\nconst mapForm = document.querySelector('.map__filters');\nconst mapFormFieldsets = mapForm.querySelectorAll('.map__filter, .map__features');\n\nconst MIN_TITLE_LENGTH = 30;\nconst MAX_TITLE_LENGTH = 100;\nconst MAX_PRICE_PER_NIGHT = 1000000;\n\nconst minPrices = {\n  bungalow: 0,\n  flat: 1000,\n  house: 5000,\n  palace: 10000,\n}\n  \nconst getAddress = (lat, lng) => {\n  const latitude = lat.toFixed(FIXED_NUMBER);\n  const longitude = lng.toFixed(FIXED_NUMBER);\n  address.value = `${latitude} ${longitude}`\n};\n\nconst numberOfRooms = {\n  1: [1],\n  2: [1,2],\n  3: [1,2,3],\n  100: [0],\n};\n\n//FORM UNAVAILABLE\nadFormFieldsets.forEach((input) => {\n  input.setAttribute('disabled', '');\n});\n\nmapForm.classList.add('map__filters--disabled');\nmapFormFieldsets.forEach((space) => {\n  space.setAttribute('disabled', '');\n});\n\n//FORM AVAILABLE\nconst formActivation = () => {\n  adFormFieldsets.forEach((input) => {\n    input.removeAttribute('disabled', '');\n  });\n\n  mapForm.classList.remove('map__filters--disabled');\n  mapFormFieldsets.forEach((space) => {\n    space.removeAttribute('disabled', '');\n  });\n}\n\n//ROOMS NUMBER CHECK\nconst onRoomsNumberSelect = () => {\n  const capacityOptions = selectCapacity.querySelectorAll('option');\n  const roomsNumber = Number(selectRoomNumber.value);\n  const availableRooms = numberOfRooms[roomsNumber];\n\n  capacityOptions.forEach((option) => {\n    option.disabled = true;\n  });\n\n  availableRooms.forEach((numberOfSeats) => {\n    capacityOptions.forEach((option) => {\n      if (Number(option.value) === numberOfSeats) {\n        option.disabled = false;\n      }\n    });\n    if (!availableRooms.includes(Number(selectCapacity.value))) {\n      const maxCapacity = availableRooms[availableRooms.length - 1];\n      selectCapacity.value = maxCapacity;\n    }\n  });\n};\n\nselectRoomNumber.addEventListener('change', onRoomsNumberSelect);\n\n//CHECK_IN_TIME CHECK_OUT_TIME CONNECTION\nconst onCheckInTime = () => {\n  checkOutTime.value = checkInTime.value;\n}\nconst onCheckOutTime = () => {\n  checkInTime.value = checkOutTime.value;\n}\n\ncheckInTime.addEventListener('change', onCheckInTime);\ncheckOutTime.addEventListener('change', onCheckOutTime);\n\n//HOUSE_TYPE CONNECTION\nconst onHouseType = () => {\n  currentPrice.placeholder = minPrices[houseTypeList.value];\n  currentPrice.min = minPrices[houseTypeList.value];\n};\n\ncurrentPrice.placeholder = minPrices[houseTypeList.value];\n\nconst onPriceInput = () => {\n  const price = currentPrice.value;\n  const type = houseTypeList.value;\n  const minPrice = minPrices[type];\n\n  if (price < minPrice) {\n    currentPrice.setCustomValidity(`Стоимость должна быть не менее ${minPrice}`);\n  } else if (price > MAX_PRICE_PER_NIGHT) {\n    currentPrice.setCustomValidity(`Стоимость не должна превышать ${MAX_PRICE_PER_NIGHT}`);\n  } else {\n    currentPrice.setCustomValidity('');\n  }\n  currentPrice.reportValidity();\n};\n\ncurrentPrice.addEventListener('input', onPriceInput);\nhouseTypeList.addEventListener('change', onHouseType);\n\n//FORM VALIDATION\ntitleInput.addEventListener('input', () => {\n  const valueLength = titleInput.value.length;\n\n  if (valueLength < MIN_TITLE_LENGTH) {\n    titleInput.setCustomValidity('Ещё ' + (MIN_TITLE_LENGTH - valueLength) +' симв.');\n  } else if (valueLength > MAX_TITLE_LENGTH) {\n    titleInput.setCustomValidity('Удалите лишние ' + (valueLength - MAX_TITLE_LENGTH) +' симв.');\n  } else {\n    titleInput.setCustomValidity('');\n  }\n\n  titleInput.reportValidity();\n});\n\n//RESET\nconst formReset = () => {\n  adForm.reset();\n  mapForm.reset();\n  resetMap();\n  onRoomsNumberSelect();\n}\n\n//FORM SUBMIT\nconst offerFormSubmit = (onSuccess, onError) => {\n  adForm.addEventListener('submit', (evt) => {\n    evt.preventDefault();\n\n    const formData = new FormData(evt.target);\n\n    sendData(\n      POST_URL,\n      onSuccess,\n      onError,\n      formData,\n    );\n  });\n};\n\n//FORM RESET\nresetButton.addEventListener('click', (evt) => {\n  evt.preventDefault();\n  formReset();\n});\n\nofferFormSubmit (() => {\n  showSuccessPopup();\n  formReset();\n}, showErrorPopup)\n\nexport {formActivation, getAddress, offerFormSubmit};\nexport {mapForm, formReset};\n\n","const FIXED_NUMBER = 5;\nconst GET_URL = 'https://22.javascript.pages.academy/keksobooking/data';\nconst POST_URL = 'https://22.javascript.pages.academy/keksobooking';\n\nconst getData = (url, onSuccess, onError) => {\n  fetch(url)\n    .then ((response => {\n      if (response.ok) {\n        return response.json();\n      }\n      onError(`Не удалось загрузить данные об объектах: ${response.text}`);\n    }))\n    .then(onSuccess)\n    .catch(onError);\n};\n\nconst sendData = (url, onSuccess, onError, body) => {\n  fetch(\n    url,\n    {\n      method: 'POST',\n      body,\n    },\n  )\n    .then((response) => {\n      if (response.ok) {\n        return onSuccess();\n      }\n      onError();\n    })\n    .catch(onError);\n};\n\nexport {getData, sendData};\nexport {FIXED_NUMBER, GET_URL, POST_URL};\n","import {mapForm} from './form.js';\n\nconst filterType = mapForm.querySelector('#housing-type');\nconst filterPrice = mapForm.querySelector('#housing-price');\nconst filterRooms = mapForm.querySelector('#housing-rooms');\nconst filterGuests = mapForm.querySelector('#housing-guests');\nconst filterFeatures = mapForm.querySelector('#housing-features');\n\nconst checkType = (data) => {\n  return filterType.value === 'any' || data.offer.type === filterType.value;\n};\n\nconst checkPrice = (data) => {\n  const LOW_PRICE = 10000;\n  const HIGH_PRICE = 50000;\n  switch (filterPrice.value) {\n    case 'any':\n      return true;\n    case 'low':\n      return data.offer.price < LOW_PRICE;\n    case 'middle':\n      return data.offer.price >= LOW_PRICE && data.offer.price < HIGH_PRICE;\n    case 'high':\n      return data.offer.price >= HIGH_PRICE;\n    default:\n      return false;\n  }\n}\n\nconst checkRooms = (data) => {\n  return filterRooms.value === 'any' || data.offer.rooms === Number(filterRooms.value);\n}\n\nconst checkGuests = (data) => {\n  return filterGuests.value === 'any' || data.offer.guests === Number(filterGuests.value);\n}\n\nconst checkFeatures = (data) => {\n  const checkedFeatures = filterFeatures.querySelectorAll('.map__checkbox:checked');\n\n  let count = 0;\n  checkedFeatures.forEach((feature) => {\n    if(data.offer.features.includes(feature.value)) {\n      count++;\n    }    \n  })\n\n  return count === checkedFeatures.length;\n}\n\nconst getFilteredOffer = (data) => {\n  return (\n    checkType(data) &&\n    checkPrice(data) &&\n    checkRooms(data) &&\n    checkGuests(data) &&\n    checkFeatures(data)\n  ) \n};\n\nconst setFilterChange = (cb) => {\n  mapForm.addEventListener('change', () => {\n    cb()\n  });\n};\n\nexport {setFilterChange, getFilteredOffer};","import {offerShow} from './card.js';\nimport {formActivation, getAddress} from './form.js';\nimport {getFilteredOffer} from './filter.js';\n/* global L:readonly */\n\nconst STARTING_LATITUDE = 35.6804;\nconst STARTING_LONGITUDE = 139.7690;\nconst STARTING_ZOOM = 10;\nconst ADDS_LIMIT = 10;\n\nconst onMapLoad = () => {\n  formActivation(),\n  getAddress(STARTING_LATITUDE, STARTING_LONGITUDE);\n}\n\nconst map = L.map('map-canvas')\n  .on('load', onMapLoad)\n  .setView({\n    lat: STARTING_LATITUDE,\n    lng: STARTING_LONGITUDE,\n  },STARTING_ZOOM);\n\nL.tileLayer(\n  'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n  {\n    attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n  },\n).addTo(map);\n  \nconst mainPinIcon = L.icon({\n  iconUrl: 'img/main-pin.svg',\n  iconSize: [52, 52],\n  iconAnchor: [26, 52],\n});\n  \nconst mainPinMarker = L.marker(\n  {\n    lat: STARTING_LATITUDE,\n    lng: STARTING_LONGITUDE,\n  },\n  {\n    draggable: true,\n    icon: mainPinIcon,\n  },\n).addTo(map);\n\nconst onPinMove = (evt) => {\n  const lat = evt.target.getLatLng().lat;\n  const long = evt.target.getLatLng().lng;\n  getAddress(lat, long);\n}\n\nmainPinMarker.on('move', onPinMove);\n\nconst markers = [];\n\nconst createDefaultPin = (poster) => {\n\n  poster\n    .slice()\n    .filter(getFilteredOffer)\n    .slice(0, ADDS_LIMIT)\n    .forEach((offer) => {\n      const {location} = offer;\n\n      const defaultPinIcon = L.icon ({\n        iconUrl: 'img/pin.svg',\n        iconSize: [40, 40],\n        iconAnchor: [20, 40],\n      });\n\n      const marker = L.marker (\n        {\n          lat: location.lat,\n          lng: location.lng,\n        },\n        {\n          icon:defaultPinIcon,\n        },\n      );\n\n      marker\n        .addTo(map)\n        .bindPopup(\n          offerShow(offer),\n          {\n          },\n        );\n      marker.on('click', onPinMove); \n      markers.push(marker); \n    });\n\n};\n\n//REMOVE MARKER\n\nconst removeMarkers = () => {\n  markers.forEach((marker) => {\n    marker.remove();\n  })\n}\n\n//MAP RESET\nconst resetMap = () => {\n  map.setView({\n    lat: STARTING_LATITUDE,\n    lng: STARTING_LONGITUDE,\n  },STARTING_ZOOM);\n\n  mainPinMarker.setLatLng(L.latLng(STARTING_LATITUDE, STARTING_LONGITUDE));\n};\n\n\n\nexport {resetMap, removeMarkers, createDefaultPin};\n\n\n","import './map.js';\nimport './data.js';\nimport './utils.js';\nimport './filter.js';\nimport './form.js';\nimport './card.js';\nimport './popup.js';\nimport './avatar.js';\n/* global _:readonly */\n\nimport {getData, GET_URL} from './data.js';\nimport {showError} from './utils.js';\nimport {setFilterChange} from './filter.js';\nimport {removeMarkers, createDefaultPin} from './map.js';\nimport {formReset} from './form.js';\n\nconst RENDER_DELAY = 500;\nconst ERROR_MESSAGE = 'Не удалось загрузить данные об объектах';\n\ngetData(GET_URL, (data) => {\n  createDefaultPin(data);\n  setFilterChange(_.debounce(() => {\n    removeMarkers();\n    createDefaultPin(data);\n  }, RENDER_DELAY));\n  formReset();\n     \n\n}, showError(ERROR_MESSAGE));"],"sourceRoot":""}